# 内包表記の説明

内包表記は以下のことができます。

` '求めたい値' に for や if を空白区切りでつなげることで、どんどん内側に入れ子を実現できる`

- `[ '求めたい値' for や if ]` という構造は、以下のように変換できるというルールがあります。

  ```python
  l=[]
  for や if :
      l.append('求めたい値')
  ```

このルールに従うことで、理解がしやすいです。

- パターン A）for が 1 つ

  - 例 `[ i for i in range(1,4) ]` だと、以下と同じ意味です。
    ```python
    l=[]
    for i in in range(1,4):
        l.append(i)
    # この結果は, [1,2,3] です
    ```

- パターン B）for が 2 つ

  - パターン A）に for をプラス 1 つ追加する例 `[ i for i in range(1,4) for i in range(5,8) ]` だと、以下と同じ意味です。

    ```python
    l=[]
    for i in range(1,4):
        for i in range(5,8): # 先に書いた range(1,4) の内側に、後に書いた range(5,8) 分の入れ子が増える
            l.append(i)
    # この結果は, [5,6,7,  5,6,7,  5,6,7] です
    # ちょっとわかりにくいですが、外側のループで、iが1~3まで計3回呼ばれます。
    # 内側のループでは、その側で設定されたiを無視して、iが5~7まで計3回呼ばれます。
    # つまり、以下と同じです。(「5を加えて、6を加えて、7を加える操作」が3回繰り返されます。)
    # for i in range(1,4):
    #     l.append(5)
    #     l.append(6)
    #     l.append(7)
    ```

- パターン C） for と if が 1 つずつ

  - パターン A）に if をプラス 1 つ追加する例 `[i for i in range(1,4) if i%2==0 ]` だと、以下と同じ意味です。

    ```python
    l=[]
    for i in range(1,4):
        if i%2==0: # 先に書いた range(1,4) の内側に、後に書いたif i%2==0 分の入れ子が増える
            l.append(i)
    # この結果は, [2] です
    ```

ここから少し難しくなります。

- パターン D）'求めたい値' がタプルの場合

  - パターン A）の `i` が、長さ 2 のタプルである例 `[ (i,100) for i in range(1,4) ]` だと、以下と同じ意味です。

    ```python
    l=[]
    for i in range(1,4):
        l.append((i,100)) # 単純な i から (i,100) になる
    # この結果は, [(1,100), (2,100), (3,100)] です
    ```

- パターン E）'求めたい値' がタプルかつ、二つの変数がある場合

  - パターン D）と比べて、`(i,100)` 内の 100 が j と変化し、かつ、j についても for を追加する例 `[ (i,j) for i in range(1,4) for in range(5,8) ]` だと、以下と同じ意味です。

    ```python
    l=[]
    for i in range(1,4):
        for i in range(5,8): # 入れ子が増える
            l.append((i,j)) # (i,100) から (i,j)になる
    # この結果は、テキスト第4章 第5節 第3項 「1つの内包表記でfor文を複数指定する」にのっています！
    ```

ここまで、ついてこられていますか？（日本語わかりにくければすみません。。）  
もっとむずかしくなります。

- パターン F）'求めたい値' 自体が内容表記である場合

  - パターン A）の `i` が、`[i for in range(5,8)]` である例 `[  [i for in range(5,8)]  for i in range(1,4) ]` だと、一旦、`[(i, j) for i in range(5,8)]` 部分を「X」と置き換えてみると、以下と同じ意味です。

    ```python
    l=[]
    for i in range(1,4):
        l.append(「X」) # i から 「X」 になる
    ```

  - 次に、一旦置き換えた「X」の中身である `[i for range(5,8)]` は さらに `[5,6,7]` と置き換えられるので、以下と同じ意味になります。

    ```python
    l=[]
    for i in range(1,4):
        l.append([5,6,7]) #「X」である、[i for range(5,8)] が [5,6,7]になる
    # この結果は、[  [5,6,7],  [5,6,7],  [5,6,7] ] です。
    ```

- パターン G）合わせ技の場合
  - 例 `[ [(i,j) for i in range(1,4)] for j in range(5,8) ]`
    - まず、パターン F）を見習って、`[(i,j) for i in range(1,4)]`を「X」として、書き換えてみます。
      ```python
      l=[]
      for j in range(5,8):
          l.append(「X」)
      ```
    - ここで、「X」は、パターン D）を見習うと、`[(1,j), (2,j), (3,j)]` と書き換えられます。
    - なので、最終的には、以下と書き換えられます。
      ```python
      l=[]
      for j in range(5,8):
          l.append([(1,j), (2,j), (3,j)])
      # この結果は、[ [(1,5), (2,5), (3,5)]  [(1,6), (2,6), (3,6)]   [(1,7), (2,7), (3,7)]   ]です。
      # この結果は、テキスト第4章 第5節 第3項 「内包表記を入れ子にする」と同じです。
      ```

よくできました！  
お疲れ様です！

# 練習問題

次のコードと同じ表示結果を出力する記述として正しいものは、A〜D のうち、どれでしょうか？（1 つのみが正解です）

```python
data = []
for x in [1, 2, 3]:
    for y in [1 ,2]:
        if x != y:
            data.append((x, y))
print(data)
```

A. `print(  [(x, y) for x in [1 ,2 ,3] for y in [1 ,2] if x != y]  )`

B. `print(  [(y, x) for x in [1 ,2 ,3] for y in [1 ,2] if x != y]  )`

C. `print(  [(x, y) for y in [1 ,2] for x in [1 ,2, 3] if x != y]  )`

D. `print(  [(y, x) for y in [1 ,2] for x in [1 ,2, 3] if x != y]  )`

# 練習問題

1. 次のコードを実行した結果として正しいものを選択してください。

   ```python
   for i, c in enumerate("WOAD"):
     if i == 2:
       print(c)
   ```

   A. W

   B. O

   C. R

   D. D

1. 次のコードを実行した結果として正しいものを選択してください。

   ```python
   print(list(reversed(sorted("EAT"))))
   ```

   A. ['E', 'A', 'T']

   B. ['A', 'E', 'T']

   C. ['T', 'A', 'E']

   D. ['T', 'E', 'A']
